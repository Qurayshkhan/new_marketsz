import{s as Y,x as i,g as a,o as n,a as f,w as _,b as e,n as j,F as v,r as b,d as H,t as r,T as K,i as y,f as m,e as X,y as P}from"./app-DvOq4fR8.js";import Z from"./Report-B2LpzqlZ.js";import{_ as ee}from"./TextInput-C_S-HQzm.js";import{D as se,_ as R}from"./Modal-g_Uy0ImF.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AuthenticatedLayout-C5Jll4xb.js";const le={class:"grid grid-cols-12 gap-4"},oe={class:"col-span-9"},ae={class:"w-full border text-center data-table text-sm"},ne={class:"uppercase bg-gray-100"},re=["onClick"],de=["onClick"],ie={key:0,class:"bg-gray-50"},ue={colspan:"5",class:"text-left px-5"},ce={class:"w-full my-5"},pe={class:"flex items-center justify-between"},ve={class:"flex flex-col items-start"},ge=["onClick"],fe={class:"text-lg"},ye={class:"text-md text-gray-600"},me={key:0,class:"text-sm"},he={colspan:"5"},xe={class:"flex items-center justify-between"},_e={colspan:"5"},be={class:"my-2 w-full"},we={key:0},ke={class:"my-2 flex gap-2 items-center"},Ce={class:""},Se={class:"text-red-500"},Pe={colspan:"5"},De={class:"flex items-center justify-between w-full"},Ie={class:"w-full"},Ue={class:"relative w-full max-w-md"},Fe={class:"block truncate"},qe={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-sm ring-1 ring-black ring-opacity-5 overflow-auto"},Me=["onClick"],Te={class:"flex justify-between font-medium"},$e={class:"text-primary-500 fw-bold"},Ae={class:"text-primary-600"},Ne={class:"text-gray-500 text-xs mt-1"},je={key:0,class:"py-2"},Re={class:"bold"},Ve={class:"text-primary-800"},ze=["disabled","onClick"],Be={class:"p-6 space-y-4"},Oe={key:0,class:"mt-4"},Ee={class:"list-disc pl-5 text-sm text-gray-700 space-y-1"},Ge={class:"flex justify-end gap-2"},Je={class:"p-6 space-y-4"},Le={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Qe=["src"],We={key:1,class:"text-center text-gray-900"},Ye={__name:"ActionRequired",props:{actions:Object,specialRequests:Object},setup(V){const c=V,p=Y(),w=c.actions,u=i(new Set),F=i(null),k=i(!1),C=i(!1),D=i(!1),I=i(!1),h=i(null),x=i([]),q=i(null),U=i(!1),S=i([]),z=o=>{u.value.has(o)?u.value.delete(o):u.value.add(o)},B=()=>{u.value.size===w.length?u.value.clear():u.value=new Set(w.map(o=>o.id))},O=()=>u.value.size===w.length,M=()=>{k.value=!k.value},E=(o,s)=>{F.value=o;try{const t=P.post(route("customer.packageSetSpecialRequest"),{package_id:s,special_request:o.id});p.success(t.message||"Special request added successfully.")}catch(t){p.error(t)}finally{k.value=!1}},T=()=>{C.value=!C.value},g=()=>{D.value=!1,I.value=!1,x.value=[],S.value=[]},$=o=>{q.value=o,D.value=!0},G=o=>{x.value=Array.from(o.target.files)},J=async()=>{var s,t;U.value=!0;const o=new FormData;x.value.forEach(d=>o.append("invoices[]",d)),o.append("package_id",q.value),o.append("status",2);try{const d=await P.post(route("customers.packageUploadInvoices"),o,{headers:{"Content-Type":"multipart/form-data"}});p.success(d.data.message||"Invoices uploaded successfully"),g(),setTimeout(()=>{window.location.reload()},1e3)}catch(d){p.error(((t=(s=d.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to upload invoices")}finally{U.value=!1}close()},L=async(o,s)=>{o.preventDefault();try{const t=await P.post(route("customer.packageAddNote"),{note:h.value,id:s});C.value=!1,p.success(t.data.message)}catch{p.error(response.data.message)}},Q=async o=>{try{const s=await P.get(route("customers.packageGetPhotos",{package_id:o}));S.value=s.data.data||[],I.value=!0}catch{p.error("Failed to fetch photos")}};return(o,s)=>(n(),a(v,null,[f(Z,{actionCount:c==null?void 0:c.actions},{default:_(()=>[e("div",le,[e("div",oe,[e("table",ae,[e("thead",ne,[e("tr",null,[e("th",null,[e("i",{onClick:B,class:j(["cursor-pointer",["fa-solid",O()?"fa-angles-down":"fa-angles-right","text-primary-500"]])},null,2)]),s[6]||(s[6]=e("th",null,"From",-1)),s[7]||(s[7]=e("th",null,"Package ID",-1)),s[8]||(s[8]=e("th",null,"Date Received",-1)),s[9]||(s[9]=e("th",{class:"bg-primary-500 text-white"}," Action Required ",-1))])]),e("tbody",null,[(n(!0),a(v,null,b(H(w),t=>(n(),a(v,{key:t.id},[e("tr",null,[e("td",{onClick:d=>z(t.id),class:"cursor-pointer"},[e("i",{class:j(["fas",u.value.has(t.id)?"fa-chevron-down":"fa-chevron-right","text-primary-500"])},null,2)],8,re),e("td",null,r(t.from),1),e("td",null,r(t.package_id),1),e("td",null,r(o.__format_date_time(t.date_received)),1),e("td",null,[e("div",null,[e("button",{class:"text-primary-500",onClick:d=>$(t.id)}," Upload Merchant Invoice ",8,de),s[10]||(s[10]=e("p",null,"As required by Customs",-1))])])]),f(K,{name:"fade"},{default:_(()=>{var d,A,N;return[u.value.has(t.id)?(n(),a("tr",ie,[e("td",ue,[s[24]||(s[24]=e("div",null,[e("strong",null,"Upload Merchant Invoice"),e("p",{class:"text-sm text-gray-600"}," Please upload the merchant invoice for this package. When your invoice is successfully uploaded, your package will be placed In Review until it is verified by Marketsz "),e("hr")],-1)),e("table",ce,[e("thead",null,[e("th",null,[e("div",pe,[e("div",ve,[s[11]||(s[11]=e("p",null," Package Details ",-1)),e("p",null," To: "+r((d=t==null?void 0:t.customer)==null?void 0:d.name),1)]),e("div",null,[e("button",{class:"btn bg-white text-black",onClick:l=>Q(t.id)}," Photo ",8,ge)])])]),s[12]||(s[12]=e("th",null,"Qty",-1)),s[13]||(s[13]=e("th",null,"Value Per Unit (USD)",-1)),s[14]||(s[14]=e("th",null,"Total Line Value (USD)",-1))]),e("tbody",null,[(n(!0),a(v,null,b(t.items,l=>(n(),a("tr",{key:l.id,class:"border bg-[#e8e7e7]"},[e("td",null,[e("p",fe,r(l==null?void 0:l.title),1),e("p",ye,r(l==null?void 0:l.description),1),l!=null&&l.item_note?(n(),a("p",me,r(l==null?void 0:l.item_note),1)):y("",!0)]),e("td",null,r(l==null?void 0:l.quantity),1),e("td",null,r(l==null?void 0:l.value_per_unit),1),e("td",null,r(l==null?void 0:l.total_line_value),1)]))),128)),e("tr",null,[e("td",he,[e("div",xe,[e("p",null,[s[15]||(s[15]=e("span",{class:"uppercase"},"Total weight: ",-1)),m(r(t==null?void 0:t.weight)+" lbs ",1)]),e("p",null,[s[16]||(s[16]=e("span",{class:"uppercase"},"Total value of this package: ",-1)),m(r(t.total_value)+" USD ",1)])])])]),e("tr",null,[e("td",_e,[e("div",be,[e("a",{onClick:s[0]||(s[0]=l=>T()),href:"#",class:"text-red-700"},"Add your notes"),s[17]||(s[17]=m(" to this package, this is for your use only, Marketsz will not review this area. "))]),C.value?(n(),a("div",we,[f(ee,{class:"w-full",placeholder:"Please add note here",modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=l=>h.value=l)},null,8,["modelValue"]),e("div",ke,[f(se,{onClick:X(l=>L(l,t.id),["prevent"])},{default:_(()=>s[18]||(s[18]=[m(" Save your note ")])),_:2,__:[18]},1032,["onClick"]),e("a",{onClick:s[2]||(s[2]=l=>T()),href:"javascript:void(0)"},"Cancel")])])):y("",!0),e("p",Ce,[s[19]||(s[19]=m(" Note: ")),e("span",Se,r(h.value?h.value:t==null?void 0:t.note),1)]),s[20]||(s[20]=e("hr",null,null,-1))])]),e("tr",null,[e("td",Pe,[e("div",De,[e("div",Ie,[s[23]||(s[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Optional Services",-1)),e("div",Ue,[e("button",{type:"button",class:"w-full border border-gray-300 bg-white rounded-md shadow-sm pl-4 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-sm",onClick:s[3]||(s[3]=(...l)=>M&&M(...l))},[e("span",Fe,r(((A=F.value)==null?void 0:A.title)||"Select Optional Service"),1),s[21]||(s[21]=e("span",{class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none"},[e("i",{class:"fa fa-chevron-down text-gray-400"})],-1))]),k.value?(n(),a("ul",qe,[(n(!0),a(v,null,b(c==null?void 0:c.specialRequests,(l,W)=>(n(),a("li",{key:W,class:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:He=>E(l,t.id)},[e("div",Te,[e("span",$e,r(l.title),1),e("span",Ae,"$"+r(l.price),1)]),e("p",Ne,r(l.description),1)],8,Me))),128))])):y("",!0)]),t.special_request?(n(),a("div",je,[e("p",Re,[s[22]||(s[22]=m(" Your current special request is: ")),e("span",Ve,r(((N=t.special_request)==null?void 0:N.title)??""),1)])])):y("",!0)]),e("button",{disabled:U.value,type:"button",class:"btn btn-big mt-4 bg-primary-600 text-white hover:bg-primary-700 disabled:bg-primary-400",onClick:l=>$(t.id)}," Upload Invoice ",8,ze)])])])])])])])):y("",!0)]}),_:2},1024)],64))),128))])])]),s[25]||(s[25]=e("div",{class:"col-span-3 bg-gray-50 p-4 rounded"},[e("p",null,"All values are in United States dollars (USD).")],-1))])]),_:1},8,["actionCount"]),f(R,{show:D.value,onClose:g},{default:_(()=>[e("div",Be,[e("div",{class:"flex justify-between items-center"},[s[26]||(s[26]=e("h2",{class:"text-lg font-semibold text-gray-900"}," Upload Merchant Invoice ",-1)),e("button",{onClick:g,class:"text-gray-500 hover:text-gray-800"}," Close ")]),e("div",null,[e("input",{type:"file",multiple:"",onChange:s[4]||(s[4]=t=>G(t))},null,32),s[27]||(s[27]=e("p",{class:"text-sm text-gray-600 mt-1"}," Accepted File Types: BMP, JPG, JPEG, GIF, TIF, TIFF, PDF ",-1)),s[28]||(s[28]=e("p",{class:"text-sm text-gray-600"},"Max File Size: 2MB",-1))]),x.value.length?(n(),a("div",Oe,[s[29]||(s[29]=e("p",{class:"font-medium text-sm mb-1"},"Selected Files:",-1)),e("ul",Ee,[(n(!0),a(v,null,b(x.value,(t,d)=>(n(),a("li",{key:d},r(t.name),1))),128))])])):y("",!0),e("div",Ge,[e("button",{onClick:s[5]||(s[5]=t=>g()),class:"px-4 py-2 text-sm text-gray-700 border"}," Cancel "),e("button",{onClick:J,class:"px-4 py-2 text-sm bg-primary-600 text-white"}," Upload Document ")])])]),_:1},8,["show"]),f(R,{show:I.value,onClose:g},{default:_(()=>[e("div",Je,[e("div",{class:"flex justify-between items-center"},[s[30]||(s[30]=e("h2",{class:"text-lg font-semibold text-gray-900"}," Package Photos ",-1)),e("button",{onClick:g,class:"text-gray-500 hover:text-gray-800"}," Close ")]),S.value.length>0?(n(),a("div",Le,[(n(!0),a(v,null,b(S.value,(t,d)=>(n(),a("img",{key:d,src:t.file_with_url,alt:"Package Photo",class:"rounded shadow border"},null,8,Qe))),128))])):(n(),a("div",We,s[31]||(s[31]=[e("h3",null,"No photos available",-1)])))])]),_:1},8,["show"])],64))}},ls=te(Ye,[["__scopeId","data-v-d9830c8a"]]);export{ls as default};
