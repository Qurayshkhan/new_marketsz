import{s as X,x as i,g as n,o as d,a as m,w as _,b as t,n as A,F as y,r as C,d as Z,t as a,T as tt,i as h,f as x,e as st,y as T}from"./app-CLH4PAu6.js";import et from"./Report-sOy3FrIO.js";import{_ as lt}from"./TextInput-CDsR7Xf7.js";import{D as ot,_ as z}from"./Modal-ClUnmR2L.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AuthenticatedLayout-DUb1P-6k.js";const nt={class:"grid grid-cols-12 gap-4"},dt={class:"col-span-9"},ut={class:"w-full border text-center data-table text-sm"},rt={class:"uppercase bg-gray-100"},it=["onClick"],ct={key:0,class:"bg-gray-50"},pt={colspan:"6",class:"text-left px-5"},gt={class:"w-full my-5"},ft={class:"flex items-center justify-between"},yt={class:"flex flex-col items-start"},vt=["onClick"],mt={class:"text-lg"},ht={class:"text-md text-gray-600"},xt={key:0,class:"text-sm"},bt={colspan:"5"},kt={class:"flex items-center justify-between"},_t={colspan:"5"},Ct={class:"my-2 w-full"},wt={key:0},St={class:"my-2 flex gap-2 items-center"},Pt={class:""},Dt={class:"text-red-500"},Tt={colspan:"5"},It={class:"flex items-center justify-between w-full"},Ft={class:"w-full"},Ut={class:"relative w-full max-w-md"},Rt={class:"block truncate"},Mt={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-sm ring-1 ring-black ring-opacity-5 overflow-auto"},Nt=["onClick"],$t={class:"flex justify-between font-medium"},jt={class:"text-primary-500 fw-bold"},qt={class:"text-primary-600"},Vt={class:"text-gray-500 text-xs mt-1"},At={key:0,class:"py-2"},zt={class:"bold"},Bt={class:"text-primary-800"},Ot=["disabled","onClick"],Et={class:"p-6 space-y-4"},Gt={key:0,class:"mt-4"},Jt={class:"list-disc pl-5 text-sm text-gray-700 space-y-1"},Lt={class:"flex justify-end gap-2"},Wt={class:"p-6 space-y-4"},Qt={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Yt=["src"],Ht={key:1,class:"text-center text-gray-900"},Kt={__name:"InReview",props:{inReviews:Object,specialRequests:Object,packageCounts:Array},setup(B){const u=B,g=X(),w=u.inReviews,c=i(new Set),R=i(null),S=i(!1),P=i(!1),I=i(!1),F=i(!1),b=i(null),k=i([]),M=i(null),U=i(!1),D=i([]),O=o=>{c.value.has(o)?c.value.delete(o):c.value.add(o)},E=()=>{c.value.size===w.length?c.value.clear():c.value=new Set(w.map(o=>o.id))},G=()=>c.value.size===w.length,N=()=>{S.value=!S.value},J=(o,s)=>{R.value=o;try{const r=T.post(route("customer.packageSetSpecialRequest"),{package_id:s,special_request:o.id});g.success(r.message||"Special request added successfully.")}catch(r){g.error(r)}finally{S.value=!1}},$=()=>{P.value=!P.value},v=()=>{I.value=!1,F.value=!1,k.value=[],D.value=[]},L=o=>{M.value=o,I.value=!0},W=o=>{k.value=Array.from(o.target.files)},Q=async()=>{var s,r;U.value=!0;const o=new FormData;k.value.forEach(p=>o.append("invoices[]",p)),o.append("package_id",M.value),o.append("status",2);try{const p=await T.post(route("customers.packageUploadInvoices"),o,{headers:{"Content-Type":"multipart/form-data"}});g.success(p.data.message||"Invoices uploaded successfully"),v(),setTimeout(()=>{window.location.reload()},1e3)}catch(p){g.error(((r=(s=p.response)==null?void 0:s.data)==null?void 0:r.message)||"Failed to upload invoices")}finally{U.value=!1}close()},Y=async(o,s)=>{o.preventDefault();try{const r=await T.post(route("customer.packageAddNote"),{note:b.value,id:s});P.value=!1,g.success(r.data.message)}catch{g.error(response.data.message)}},H=async o=>{try{const s=await T.get(route("customers.packageGetPhotos",{package_id:o}));D.value=s.data.data||[],F.value=!0}catch{g.error("Failed to fetch photos")}};return(o,s)=>{var r,p,j;return d(),n(y,null,[m(et,{actionCount:u==null?void 0:u.packageCounts.action_required,inReviewCount:(r=u==null?void 0:u.packageCounts)==null?void 0:r.in_review,readyToSendCount:(p=u==null?void 0:u.packageCounts)==null?void 0:p.ready_to_send,allPackagesCount:(j=u==null?void 0:u.packageCounts)==null?void 0:j.all},{default:_(()=>[t("div",nt,[t("div",dt,[t("table",ut,[t("thead",rt,[t("tr",null,[t("th",null,[t("i",{onClick:E,class:A(["cursor-pointer",["fa-solid",G()?"fa-angles-down":"fa-angles-right","text-primary-500"]])},null,2)]),s[6]||(s[6]=t("th",null,"From",-1)),s[7]||(s[7]=t("th",null,"Package ID",-1)),s[8]||(s[8]=t("th",null,"Date Received",-1)),s[9]||(s[9]=t("th",null,"Total value",-1)),s[10]||(s[10]=t("th",null,"Total weight",-1))])]),t("tbody",null,[(d(!0),n(y,null,C(Z(w),l=>(d(),n(y,{key:l.id},[t("tr",null,[t("td",{onClick:f=>O(l.id),class:"cursor-pointer"},[t("i",{class:A(["fas",c.value.has(l.id)?"fa-chevron-down":"fa-chevron-right","text-primary-500"])},null,2)],8,it),t("td",null,a(l.from),1),t("td",null,a(l.package_id),1),t("td",null,a(o.__format_date_time(l.date_received)),1),t("td",null,a(o.__to_fixed_number(l.total_value))+" USD ",1),t("td",null,a(l.weight)+" lbs",1)]),m(tt,{name:"fade"},{default:_(()=>{var f,q,V;return[c.value.has(l.id)?(d(),n("tr",ct,[t("td",pt,[s[24]||(s[24]=t("div",null,[t("strong",{class:"bold"},"Why is this package in review?"),t("p",{class:"text-sm text-gray-600"}," Please upload the merchant invoice for this package. When your invoice is successfully uploaded, your package will be placed In Review until it is verified by Marketsz "),t("hr")],-1)),t("table",gt,[t("thead",null,[t("th",null,[t("div",ft,[t("div",yt,[s[11]||(s[11]=t("p",null," Package Details ",-1)),t("p",null," To: "+a((f=l==null?void 0:l.customer)==null?void 0:f.name),1)]),t("div",null,[t("button",{class:"btn bg-white text-black",onClick:e=>H(l.id)}," Photo ",8,vt)])])]),s[12]||(s[12]=t("th",null,"Qty",-1)),s[13]||(s[13]=t("th",null,"Value Per Unit (USD)",-1)),s[14]||(s[14]=t("th",null,"Total Line Value (USD)",-1))]),t("tbody",null,[(d(!0),n(y,null,C(l.items,e=>(d(),n("tr",{key:e.id,class:"border bg-[#e8e7e7]"},[t("td",null,[t("p",mt,a(e==null?void 0:e.title),1),t("p",ht,a(e==null?void 0:e.description),1),e!=null&&e.item_note?(d(),n("p",xt,a(e==null?void 0:e.item_note),1)):h("",!0)]),t("td",null,a(e==null?void 0:e.quantity),1),t("td",null,a(e==null?void 0:e.value_per_unit),1),t("td",null,a(e==null?void 0:e.total_line_value),1)]))),128)),t("tr",null,[t("td",bt,[t("div",kt,[t("p",null,[s[15]||(s[15]=t("span",{class:"uppercase"},"Total weight: ",-1)),x(a(l==null?void 0:l.weight)+" lbs ",1)]),t("p",null,[s[16]||(s[16]=t("span",{class:"uppercase"},"Total value of this package: ",-1)),x(a(l.total_value)+" USD ",1)])])])]),t("tr",null,[t("td",_t,[t("div",Ct,[t("a",{onClick:s[0]||(s[0]=e=>$()),href:"#",class:"text-red-700"},"Add your notes"),s[17]||(s[17]=x(" to this package, this is for your use only, Marketsz will not review this area. "))]),P.value?(d(),n("div",wt,[m(lt,{class:"w-full",placeholder:"Please add note here",modelValue:b.value,"onUpdate:modelValue":s[1]||(s[1]=e=>b.value=e)},null,8,["modelValue"]),t("div",St,[m(ot,{onClick:st(e=>Y(e,l.id),["prevent"])},{default:_(()=>s[18]||(s[18]=[x(" Save your note ")])),_:2,__:[18]},1032,["onClick"]),t("a",{onClick:s[2]||(s[2]=e=>$()),href:"javascript:void(0)"},"Cancel")])])):h("",!0),t("p",Pt,[s[19]||(s[19]=x(" Note: ")),t("span",Dt,a(b.value?b.value:l==null?void 0:l.note),1)]),s[20]||(s[20]=t("hr",null,null,-1))])]),t("tr",null,[t("td",Tt,[t("div",It,[t("div",Ft,[s[23]||(s[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Optional Services",-1)),t("div",Ut,[t("button",{type:"button",class:"w-full border border-gray-300 bg-white rounded-md shadow-sm pl-4 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-sm",onClick:s[3]||(s[3]=(...e)=>N&&N(...e))},[t("span",Rt,a(((q=R.value)==null?void 0:q.title)||"Select Optional Service"),1),s[21]||(s[21]=t("span",{class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none"},[t("i",{class:"fa fa-chevron-down text-gray-400"})],-1))]),S.value?(d(),n("ul",Mt,[(d(!0),n(y,null,C(u==null?void 0:u.specialRequests,(e,K)=>(d(),n("li",{key:K,class:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:Xt=>J(e,l.id)},[t("div",$t,[t("span",jt,a(e.title),1),t("span",qt,"$"+a(e.price),1)]),t("p",Vt,a(e.description),1)],8,Nt))),128))])):h("",!0)]),l.special_request?(d(),n("div",At,[t("p",zt,[s[22]||(s[22]=x(" Your current special request is: ")),t("span",Bt,a(((V=l.special_request)==null?void 0:V.title)??""),1)])])):h("",!0)]),t("button",{disabled:U.value,type:"button",class:"btn btn-big mt-4 bg-primary-600 text-white hover:bg-primary-700 disabled:bg-primary-400",onClick:e=>L(l.id)}," Upload Invoice ",8,Ot)])])])])])])])):h("",!0)]}),_:2},1024)],64))),128))])])]),s[25]||(s[25]=t("div",{class:"col-span-3 bg-gray-50 p-4 rounded"},[t("p",null,"All values are in United States dollars (USD).")],-1))])]),_:1},8,["actionCount","inReviewCount","readyToSendCount","allPackagesCount"]),m(z,{show:I.value,onClose:v},{default:_(()=>[t("div",Et,[t("div",{class:"flex justify-between items-center"},[s[26]||(s[26]=t("h2",{class:"text-lg font-semibold text-gray-900"}," Upload Merchant Invoice ",-1)),t("button",{onClick:v,class:"text-gray-500 hover:text-gray-800"}," Close ")]),t("div",null,[t("input",{type:"file",multiple:"",onChange:s[4]||(s[4]=l=>W(l))},null,32),s[27]||(s[27]=t("p",{class:"text-sm text-gray-600 mt-1"}," Accepted File Types: BMP, JPG, JPEG, GIF, TIF, TIFF, PDF ",-1)),s[28]||(s[28]=t("p",{class:"text-sm text-gray-600"},"Max File Size: 2MB",-1))]),k.value.length?(d(),n("div",Gt,[s[29]||(s[29]=t("p",{class:"font-medium text-sm mb-1"},"Selected Files:",-1)),t("ul",Jt,[(d(!0),n(y,null,C(k.value,(l,f)=>(d(),n("li",{key:f},a(l.name),1))),128))])])):h("",!0),t("div",Lt,[t("button",{onClick:s[5]||(s[5]=l=>v()),class:"px-4 py-2 text-sm text-gray-700 border"}," Cancel "),t("button",{onClick:Q,class:"px-4 py-2 text-sm bg-primary-600 text-white"}," Upload Document ")])])]),_:1},8,["show"]),m(z,{show:F.value,onClose:v},{default:_(()=>[t("div",Wt,[t("div",{class:"flex justify-between items-center"},[s[30]||(s[30]=t("h2",{class:"text-lg font-semibold text-gray-900"}," Package Photos ",-1)),t("button",{onClick:v,class:"text-gray-500 hover:text-gray-800"}," Close ")]),D.value.length>0?(d(),n("div",Qt,[(d(!0),n(y,null,C(D.value,(l,f)=>(d(),n("img",{key:f,src:l.file_with_url,alt:"Package Photo",class:"rounded shadow border"},null,8,Yt))),128))])):(d(),n("div",Ht,s[31]||(s[31]=[t("h3",null,"No photos available",-1)])))])]),_:1},8,["show"])],64)}}},as=at(Kt,[["__scopeId","data-v-4461fd11"]]);export{as as default};
