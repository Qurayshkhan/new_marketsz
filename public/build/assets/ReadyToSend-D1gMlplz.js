import{C as tt,q as u,D as et,E as st,I as lt,g as r,o as i,a as f,w,b as t,n as F,k as O,x as E,F as _,r as q,d as ot,t as a,T as at,i as b,f as h,e as nt,J as R,y as rt}from"./app-DkUkVBZ9.js";import it from"./Report-3S_INWz9.js";import{_ as ut}from"./TextInput-phx9tQ01.js";import{D as ct}from"./DangerButton-8tXlj7e6.js";import{_ as dt}from"./Modal-B3AhaWax.js";import{_ as pt}from"./PrimaryButton-zxniru5U.js";import{_ as ft}from"./PackageLinks.vue_vue_type_script_setup_true_lang-BojCB4wk.js";import{C as gt}from"./CurrencyDollarText-BQ84e0j4.js";import{_ as vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AuthenticatedLayout-DvmO3E8q.js";const mt={class:"grid grid-cols-12 gap-4"},ht={class:"col-span-9"},_t={class:"w-full border text-center data-table text-sm"},xt={class:"uppercase bg-gray-100"},wt=["onClick"],bt={class:"whitespace-nowrap !text-center"},kt=["value"],yt={key:0,class:"bg-gray-50"},Ct={colspan:"6",class:"text-left px-5"},Pt={class:"w-full my-5"},qt={class:"flex items-center justify-between"},Dt={class:"flex flex-col items-start"},Rt=["onClick"],Nt={class:"text-lg"},Vt={class:"text-md text-gray-600"},jt={key:0,class:"text-sm"},Ut={colspan:"5"},$t={class:"flex items-center justify-between"},Mt={colspan:"5"},At={class:"flex items-center justify-between w-full"},It={class:"w-full"},zt={class:"relative w-full max-w-md"},Ft={class:"block truncate"},Ot={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-sm ring-1 ring-black ring-opacity-5 overflow-auto"},Et=["onClick"],Bt={class:"flex justify-between font-medium"},Ht={class:"text-primary-500 fw-bold"},Lt={class:"text-primary-600"},Gt={class:"text-gray-500 text-xs mt-1"},Jt={key:0,class:"py-2"},Qt={class:"bold"},Wt={class:"text-primary-800"},Yt={colspan:"6"},Kt={class:"my-2 w-full"},Xt={key:0},Zt={class:"my-2 flex gap-2 items-center"},St={class:""},Tt={class:"text-red-500"},te={class:"col-span-3 bg-gray-50 p-4 rounded"},ee={class:"col-span-3 bg-white p-4 mt-4 rounded shadow"},se={class:"text-center"},le={class:"p-6 space-y-4"},oe={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ae=["src"],ne={key:1,class:"text-center text-gray-900"},re={__name:"ReadyToSend",props:{readyToSends:Object,specialRequests:Object,packageCounts:Array},setup(B){const n=B,c=tt(),v=n.readyToSends,d=u(new Set),k=u(!1),H=u(!1),D=u(!1),x=u(null),L=u([]),y=u([]),p=u([]),C=u(!1),N=u(null),P=u(!1);et(p,()=>{C.value=p.value.length===v.length});const G=o=>{p.value=o.target.checked?v.map(e=>e.id):[]},J=()=>{C.value=!1,p.value=[]},Q=o=>{d.value.has(o)?d.value.delete(o):d.value.add(o)},W=()=>{d.value.size===v.length?d.value.clear():d.value=new Set(v.map(o=>o.id))},Y=()=>d.value.size===v.length,V=()=>{P.value=!P.value},j=()=>{k.value=!k.value},U=()=>{H.value=!1,D.value=!1,L.value=[],y.value=[]},K=async(o,e)=>{o.preventDefault();try{const g=await R.post(route("customer.packageAddNote"),{note:x.value,id:e});k.value=!1,c.success(g.data.message)}catch{c.error(response.data.message)}},X=async o=>{try{const e=await R.get(route("customers.packageGetPhotos",{package_id:o}));y.value=e.data.data||[],D.value=!0}catch{c.error("Failed to fetch photos")}};st(()=>{p.value=v.map(o=>o.id)});const Z=(o,e)=>{N.value=o;try{const g=R.post(route("customer.packageSetSpecialRequest"),{package_id:e,special_request:o.id});c.success(g.message||"Special request added successfully.")}catch(g){c.error(g)}finally{P.value=!1}},S=async()=>{if(p.value.length===0){c.error("Please select at least one package to create a ship request.");return}try{rt.post(route("customer.shipment.create"),{package_ids:p.value},{preserveScroll:!0,onSuccess:()=>{c.success("Ship request created successfully."),J()},onError:o=>{c.error(o.response.data.message||"Failed to create ship request.")}})}catch(o){c.error(o.response.data.message||"Failed to create ship request.")}};return(o,e)=>{var $,M,A;const g=lt("Head");return i(),r(_,null,[f(g,{title:"Ready to send"}),f(it,{actionCount:n==null?void 0:n.packageCounts.action_required,inReviewCount:($=n==null?void 0:n.packageCounts)==null?void 0:$.in_review,readyToSendCount:(M=n==null?void 0:n.packageCounts)==null?void 0:M.ready_to_send,allPackagesCount:(A=n==null?void 0:n.packageCounts)==null?void 0:A.all},{default:w(()=>[t("div",mt,[t("div",ht,[t("table",_t,[t("thead",xt,[t("tr",null,[t("th",null,[t("i",{onClick:W,class:F(["cursor-pointer",["fa-solid",Y()?"fa-angles-down":"fa-angles-right","text-primary-500"]])},null,2)]),e[6]||(e[6]=t("th",null,"From",-1)),e[7]||(e[7]=t("th",null,"Package ID",-1)),e[8]||(e[8]=t("th",null,"Date Received",-1)),e[9]||(e[9]=t("th",null,"Total value",-1)),e[10]||(e[10]=t("th",null,"Total weight",-1)),t("th",null,[O(t("input",{class:"border-gray-300 text-primary-600 shadow-sm focus:ring-primary-500",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>C.value=l),onChange:G},null,544),[[E,C.value]])])])]),t("tbody",null,[(i(!0),r(_,null,q(ot(v),l=>(i(),r(_,{key:l.id},[t("tr",null,[t("td",{onClick:m=>Q(l.id),class:"cursor-pointer"},[t("i",{class:F(["fas",d.value.has(l.id)?"fa-chevron-down":"fa-chevron-right","text-primary-500"])},null,2)],8,wt),t("td",null,a(l.from),1),t("td",null,a(l.package_id),1),t("td",null,a(o.__format_date_time(l.date_received)),1),t("td",null,a(o.__to_fixed_number(l.total_value))+" USD ",1),t("td",null,a(l.weight)+" lbs",1),t("td",bt,[O(t("input",{class:"border-gray-300 text-primary-600 shadow-sm focus:ring-primary-500",type:"checkbox",value:l.id,"onUpdate:modelValue":e[1]||(e[1]=m=>p.value=m)},null,8,kt),[[E,p.value]])])]),f(at,{name:"fade"},{default:w(()=>{var m,I,z;return[d.value.has(l.id)?(i(),r("tr",yt,[t("td",Ct,[e[25]||(e[25]=t("div",null,[t("strong",null,"Upload Merchant Invoice"),t("p",{class:"text-sm text-gray-600"}," Please upload the merchant invoice for this package. When your invoice is successfully uploaded, your package will be placed In Review until it is verified by Marketsz "),t("hr")],-1)),t("table",Pt,[t("thead",null,[t("th",null,[t("div",qt,[t("div",Dt,[e[11]||(e[11]=t("p",null," Package Details ",-1)),t("p",null," To: "+a((m=l==null?void 0:l.customer)==null?void 0:m.name),1)]),t("div",null,[t("button",{class:"btn bg-white text-black",onClick:s=>X(l.id)}," Photo ",8,Rt)])])]),e[12]||(e[12]=t("th",null,"Qty",-1)),e[13]||(e[13]=t("th",null,"Value Per Unit (USD)",-1)),e[14]||(e[14]=t("th",null,"Total Line Value (USD)",-1))]),t("tbody",null,[(i(!0),r(_,null,q(l.items,s=>(i(),r("tr",{key:s.id,class:"border bg-[#e8e7e7]"},[t("td",null,[t("p",Nt,a(s==null?void 0:s.title),1),t("p",Vt,a(s==null?void 0:s.description),1),s!=null&&s.item_note?(i(),r("p",jt,a(s==null?void 0:s.item_note),1)):b("",!0)]),t("td",null,a(s==null?void 0:s.quantity),1),t("td",null,a(s==null?void 0:s.value_per_unit),1),t("td",null,a(s==null?void 0:s.total_line_value),1)]))),128)),t("tr",null,[t("td",Ut,[t("div",$t,[t("p",null,[e[15]||(e[15]=t("span",{class:"uppercase"},"Total weight: ",-1)),h(a(l==null?void 0:l.weight)+" lbs ",1)]),t("p",null,[e[16]||(e[16]=t("span",{class:"uppercase"},"Total value of this package: ",-1)),h(a(l.total_value)+" USD ",1)])])])]),t("tr",null,[t("td",Mt,[t("div",At,[t("div",It,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Optional Services",-1)),t("div",zt,[t("button",{type:"button",class:"w-full border border-gray-300 bg-white rounded-md shadow-sm pl-4 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-sm",onClick:e[2]||(e[2]=(...s)=>V&&V(...s))},[t("span",Ft,a(((I=N.value)==null?void 0:I.title)||"Select Optional Service"),1),e[17]||(e[17]=t("span",{class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none"},[t("i",{class:"fa fa-chevron-down text-gray-400"})],-1))]),P.value?(i(),r("ul",Ot,[(i(!0),r(_,null,q(n==null?void 0:n.specialRequests,(s,T)=>(i(),r("li",{key:T,class:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:ie=>Z(s,l.id)},[t("div",Bt,[t("span",Ht,a(s==null?void 0:s.title),1),t("span",Lt,"$"+a(s==null?void 0:s.price),1)]),t("p",Gt,a(s==null?void 0:s.description),1)],8,Et))),128))])):b("",!0)]),l!=null&&l.special_request?(i(),r("div",Jt,[t("p",Qt,[e[18]||(e[18]=h(" Your current special request is: ")),t("span",Wt,a(((z=l.special_request)==null?void 0:z.title)??""),1)])])):b("",!0)])])])]),e[24]||(e[24]=t("tr",null,[t("td",{colspan:"6"},[t("p",{class:"text-gray-500"}," **Values shown are obtained from the merchant invoices, when available. Researched values based on current market prices have been provided above for any items that arrived without invoices. The value should be updated to reflect the actual price paid for each item, and must be confirmed. ")])],-1)),t("tr",null,[t("td",Yt,[t("div",Kt,[t("a",{onClick:e[3]||(e[3]=s=>j()),href:"#",class:"text-red-700"},"Add your notes"),e[20]||(e[20]=h(" to this package, this is for your use only, Marketsz will not review this area. "))]),k.value?(i(),r("div",Xt,[f(ut,{class:"w-full",placeholder:"Please add note here",modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s)},null,8,["modelValue"]),t("div",Zt,[f(ct,{onClick:nt(s=>K(s,l.id),["prevent"])},{default:w(()=>e[21]||(e[21]=[h(" Save your note ")])),_:2,__:[21]},1032,["onClick"]),t("a",{onClick:e[5]||(e[5]=s=>j()),href:"javascript:void(0)"},"Cancel")])])):b("",!0),t("p",St,[e[22]||(e[22]=h(" Note: ")),t("span",Tt,a(x.value?x.value:l==null?void 0:l.note),1)]),e[23]||(e[23]=t("hr",null,null,-1))])])])])])])):b("",!0)]}),_:2},1024)],64))),128))])])]),t("div",te,[f(gt),t("div",ee,[e[27]||(e[27]=t("div",{class:"flex items-center justify-between md:flex-wrap"},[t("h3",{class:"text-lg font-semibold mb-2"}," Estimated Shipping: "),t("p",{class:"text-red-600 font-medium mt-2"},"N/A")],-1)),e[28]||(e[28]=t("p",{class:"text-sm text-gray-700"},"How is this calculated?",-1)),e[29]||(e[29]=t("p",{class:"text-sm text-gray-700 mt-2"}," One or more packages in this ship request cannot be delivered. Please contact customer service for more information. ",-1)),t("div",se,[f(pt,{class:"mt-4 font-medium",onClick:S},{default:w(()=>e[26]||(e[26]=[h(" Create ship request ")])),_:1,__:[26]})]),e[30]||(e[30]=t("p",{class:"text-sm text-gray-600 mt-2"}," All items are subject to a customs duty upon receipt of package. Payment will be due when your package is delivered. ",-1))]),f(ft)])])]),_:1},8,["actionCount","inReviewCount","readyToSendCount","allPackagesCount"]),f(dt,{show:D.value,onClose:U},{default:w(()=>[t("div",le,[t("div",{class:"flex justify-between items-center"},[e[31]||(e[31]=t("h2",{class:"text-lg font-semibold text-gray-900"}," Package Photos ",-1)),t("button",{onClick:U,class:"text-gray-500 hover:text-gray-800"}," Close ")]),y.value.length>0?(i(),r("div",oe,[(i(!0),r(_,null,q(y.value,(l,m)=>(i(),r("img",{key:m,src:l.file_with_url,alt:"Package Photo",class:"rounded shadow border"},null,8,ae))),128))])):(i(),r("div",ne,e[32]||(e[32]=[t("h3",null,"No photos available",-1)])))])]),_:1},8,["show"])],64)}}},xe=vt(re,[["__scopeId","data-v-f4e85832"]]);export{xe as default};
