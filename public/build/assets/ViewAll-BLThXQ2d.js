import{C as se,q as c,g as o,o as a,a as y,d as B,h as te,w as C,b as e,n as E,F as f,r as x,t as n,i,T as le,f as h,e as oe,J as F,y as ae}from"./app-DkUkVBZ9.js";import re from"./Report-3S_INWz9.js";import{_ as ne}from"./TextInput-phx9tQ01.js";import{D as ue}from"./DangerButton-8tXlj7e6.js";import{_ as G}from"./Modal-B3AhaWax.js";import{_ as de}from"./PackageLinks.vue_vue_type_script_setup_true_lang-BojCB4wk.js";import{C as ie}from"./CurrencyDollarText-BQ84e0j4.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AuthenticatedLayout-DvmO3E8q.js";const ce={class:"grid grid-cols-12 gap-4"},ve={class:"col-span-9"},ge={class:"w-full border text-center data-table text-sm"},ye={class:"uppercase bg-gray-100"},fe=["onClick"],me={key:0},_e={class:"text-red-500"},he={key:1,class:"text-primary-500"},be={key:2,class:"text-primary-500"},xe={class:"text-red-500"},ke={key:0,class:"bg-gray-50"},we={colspan:"7",class:"text-left px-5"},Ce={key:0},Se={key:1},Pe={class:"w-full my-5"},Re={class:"flex items-center justify-between"},De={class:"flex flex-col items-start"},Ie=["onClick"],Ae={class:"text-lg"},Fe={class:"text-md text-gray-600"},Te={key:0,class:"text-sm"},qe={colspan:"6"},Ue={class:"flex items-center justify-between"},$e={colspan:"7"},je={class:"my-2 w-full"},Me={key:0},Ne={class:"my-2 flex gap-2 items-center"},Ve={class:""},ze={class:"text-red-500"},Be={colspan:"7"},Ee={class:"flex items-center justify-between w-full"},Ge={class:"w-full"},Oe={class:"relative w-full max-w-md"},We={class:"block truncate"},Je={key:0,class:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-sm ring-1 ring-black ring-opacity-5 overflow-auto"},Le=["onClick"],Qe={class:"flex justify-between font-medium"},Ye={class:"text-primary-500 fw-bold"},He={class:"text-primary-600"},Ke={class:"text-gray-500 text-xs mt-1"},Xe={key:0,class:"py-2"},Ze={class:"bold"},es={class:"text-primary-800"},ss=["disabled","onClick"],ts={class:"col-span-3 bg-gray-50 p-4 rounded"},ls={class:"p-6 space-y-4"},os={key:0,class:"mt-4"},as={class:"list-disc pl-5 text-sm text-gray-700 space-y-1"},rs={class:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4"},ns=["src"],us=["onClick"],ds={key:1,class:"p-4 text-sm text-gray-500 bg-gray-100 border rounded"},is=["onClick"],ps={class:"flex justify-end gap-2"},cs={class:"p-6 space-y-4"},vs={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},gs=["src"],ys={key:1,class:"text-center text-gray-900"},fs={__name:"ViewAll",props:{viewAllPackages:Object,specialRequests:Object,packageCounts:Array},setup(O){const u=O,m=se(),S=u.viewAllPackages,g=c(new Set),$=c(null),P=c(!1),R=c(!1),T=c(!1),q=c(!1),k=c(null),_=c([]),j=c(null),U=c(!1),D=c([]),w=c([]),W=r=>{g.value.has(r)?g.value.delete(r):g.value.add(r)},J=()=>{g.value.size===S.length?g.value.clear():g.value=new Set(S.map(r=>r.id))},L=()=>g.value.size===S.length,M=()=>{P.value=!P.value},Q=(r,s)=>{$.value=r;try{const d=F.post(route("customer.packageSetSpecialRequest"),{package_id:s,special_request:r.id});m.success(d.message||"Special request added successfully.")}catch(d){m.error(d)}finally{P.value=!1}},N=()=>{R.value=!R.value},b=()=>{T.value=!1,q.value=!1,_.value=[],D.value=[]},Y=r=>{j.value=r,T.value=!0},H=r=>{const s=Array.from(r.target.files);_.value=s,w.value=[],s.forEach(d=>{if(d.type.startsWith("image/")){const v=new FileReader;v.onload=I=>{w.value.push(I.target.result)},v.readAsDataURL(d)}else w.value.push(null)})},V=r=>{_.value.splice(r,1),w.value.splice(r,1)},K=async()=>{var s,d;U.value=!0;const r=new FormData;_.value.forEach(v=>r.append("invoices[]",v)),r.append("package_id",j.value),r.append("status",2);try{const v=await F.post(route("customers.packageUploadInvoices"),r,{headers:{"Content-Type":"multipart/form-data"}});m.success(v.data.message||"Invoices uploaded successfully"),b(),ae.visit(route("customer.suite.inReview"))}catch(v){m.error(((d=(s=v.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to upload invoices")}finally{U.value=!1}close()},X=async(r,s)=>{r.preventDefault();try{const d=await F.post(route("customer.packageAddNote"),{note:k.value,id:s});R.value=!1,m.success(d.data.message)}catch{m.error(response.data.message)}},Z=async r=>{try{const s=await F.get(route("customers.packageGetPhotos",{package_id:r}));D.value=s.data.data||[],q.value=!0}catch{m.error("Failed to fetch photos")}};return(r,s)=>{var d,v,I;return a(),o(f,null,[y(B(te),{title:"Action Required"}),y(re,{actionCount:u==null?void 0:u.packageCounts.action_required,inReviewCount:(d=u==null?void 0:u.packageCounts)==null?void 0:d.in_review,readyToSendCount:(v=u==null?void 0:u.packageCounts)==null?void 0:v.ready_to_send,allPackagesCount:(I=u==null?void 0:u.packageCounts)==null?void 0:I.all},{default:C(()=>[e("div",ce,[e("div",ve,[e("table",ge,[e("thead",ye,[e("tr",null,[e("th",null,[e("i",{onClick:J,class:E(["cursor-pointer",["fa-solid",L()?"fa-angles-down":"fa-angles-right","text-primary-500"]])},null,2)]),s[6]||(s[6]=e("th",null,"From",-1)),s[7]||(s[7]=e("th",null,"Package ID",-1)),s[8]||(s[8]=e("th",null,"Date Received",-1)),s[9]||(s[9]=e("th",null,"Total value",-1)),s[10]||(s[10]=e("th",null,"Total weight",-1)),s[11]||(s[11]=e("th",null,"Status",-1))])]),e("tbody",null,[(a(!0),o(f,null,x(B(S),t=>(a(),o(f,{key:t.id},[e("tr",null,[e("td",{onClick:p=>W(t.id),class:"cursor-pointer"},[e("i",{class:E(["fas",g.value.has(t.id)?"fa-chevron-down":"fa-chevron-right","text-primary-500"])},null,2)],8,fe),e("td",null,n(t==null?void 0:t.from),1),e("td",null,n(t==null?void 0:t.package_id),1),e("td",null,n(r.__format_date_time(t==null?void 0:t.date_received)),1),e("td",null,n(r.__to_fixed_number(t==null?void 0:t.total_value))+" USD ",1),e("td",null,n(t==null?void 0:t.weight)+" lbs",1),e("td",null,[(t==null?void 0:t.status_name)=="Ready to Send"?(a(),o("p",me,[s[12]||(s[12]=e("i",{class:"fa-solid fa-check text-primary-500 font-extrabold"},null,-1)),s[13]||(s[13]=e("br",null,null,-1)),e("span",_e,n(t==null?void 0:t.status_name),1)])):i("",!0),(t==null?void 0:t.status_name)=="Action Required"?(a(),o("p",he,[s[14]||(s[14]=e("i",{class:"fa-solid fa-triangle-exclamation"},null,-1)),s[15]||(s[15]=e("br",null,null,-1)),e("span",null,n(t==null?void 0:t.status_name),1)])):i("",!0),(t==null?void 0:t.status_name)=="In Review"?(a(),o("p",be,[s[16]||(s[16]=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),s[17]||(s[17]=e("br",null,null,-1)),e("span",xe,n(t==null?void 0:t.status_name),1)])):i("",!0)])]),y(le,{name:"fade"},{default:C(()=>{var p,A,z;return[g.value.has(t.id)?(a(),o("tr",ke,[e("td",we,[t.status_name=="Action Required"?(a(),o("div",Ce,s[18]||(s[18]=[e("strong",null,"Upload Merchant Invoice",-1),e("p",{class:"text-sm text-gray-600"}," Please upload the merchant invoice for this package. When your invoice is successfully uploaded, your package will be placed In Review until it is verified by Marketsz ",-1),e("hr",null,null,-1)]))):i("",!0),t.status_name=="In Review"?(a(),o("div",Se,s[19]||(s[19]=[e("div",null,[e("strong",{class:"bold"},"Why is this package in review?"),e("br"),e("p",{class:"text-sm text-white bg-[#f19445] uppercase px-2 inline-block"}," Dangerous Goods "),e("p",{class:"py-1"}," We are reviewing your package and will email you if it is not ready to send within two business days. "),e("hr")],-1)]))):i("",!0),e("table",Pe,[e("thead",null,[e("th",null,[e("div",Re,[e("div",De,[s[20]||(s[20]=e("p",null," Package Details ",-1)),e("p",null," To: "+n((p=t==null?void 0:t.customer)==null?void 0:p.name),1)]),e("div",null,[e("button",{class:"btn bg-white text-black",onClick:l=>Z(t.id)}," Photo ",8,Ie)])])]),s[21]||(s[21]=e("th",null,"Qty",-1)),s[22]||(s[22]=e("th",null,"Value Per Unit (USD)",-1)),s[23]||(s[23]=e("th",null,"Total Line Value (USD)",-1))]),e("tbody",null,[(a(!0),o(f,null,x(t.items,l=>(a(),o("tr",{key:l.id,class:"border bg-[#e8e7e7]"},[e("td",null,[e("p",Ae,n(l==null?void 0:l.title),1),e("p",Fe,n(l==null?void 0:l.description),1),l!=null&&l.item_note?(a(),o("p",Te,n(l==null?void 0:l.item_note),1)):i("",!0)]),e("td",null,n(l==null?void 0:l.quantity),1),e("td",null,n(l==null?void 0:l.value_per_unit),1),e("td",null,n(l==null?void 0:l.total_line_value),1)]))),128)),e("tr",null,[e("td",qe,[e("div",Ue,[e("p",null,[s[24]||(s[24]=e("span",{class:"uppercase"},"Total weight: ",-1)),h(n(t==null?void 0:t.weight)+" lbs ",1)]),e("p",null,[s[25]||(s[25]=e("span",{class:"uppercase"},"Total value of this package: ",-1)),h(n(t.total_value)+" USD ",1)])])])]),e("tr",null,[e("td",$e,[e("div",je,[e("a",{onClick:s[0]||(s[0]=l=>N()),href:"#",class:"text-red-700"},"Add your notes"),s[26]||(s[26]=h(" to this package, this is for your use only, Marketsz will not review this area. "))]),R.value?(a(),o("div",Me,[y(ne,{class:"w-full",placeholder:"Please add note here",modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=l=>k.value=l)},null,8,["modelValue"]),e("div",Ne,[y(ue,{onClick:oe(l=>X(l,t.id),["prevent"])},{default:C(()=>s[27]||(s[27]=[h(" Save your note ")])),_:2,__:[27]},1032,["onClick"]),e("a",{onClick:s[2]||(s[2]=l=>N()),href:"javascript:void(0)"},"Cancel")])])):i("",!0),e("p",Ve,[s[28]||(s[28]=h(" Note: ")),e("span",ze,n(k.value?k.value:t==null?void 0:t.note),1)]),s[29]||(s[29]=e("hr",null,null,-1))])]),e("tr",null,[e("td",Be,[e("div",Ee,[e("div",Ge,[s[32]||(s[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Optional Services",-1)),e("div",Oe,[e("button",{type:"button",class:"w-full border border-gray-300 bg-white rounded-md shadow-sm pl-4 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500 text-sm",onClick:s[3]||(s[3]=(...l)=>M&&M(...l))},[e("span",We,n(((A=$.value)==null?void 0:A.title)||"Select Optional Service"),1),s[30]||(s[30]=e("span",{class:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none"},[e("i",{class:"fa fa-chevron-down text-gray-400"})],-1))]),P.value?(a(),o("ul",Je,[(a(!0),o(f,null,x(u==null?void 0:u.specialRequests,(l,ee)=>(a(),o("li",{key:ee,class:"px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:ms=>Q(l,t.id)},[e("div",Qe,[e("span",Ye,n(l.title),1),e("span",He,"$"+n(l.price),1)]),e("p",Ke,n(l.description),1)],8,Le))),128))])):i("",!0)]),t.special_request?(a(),o("div",Xe,[e("p",Ze,[s[31]||(s[31]=h(" Your current special request is: ")),e("span",es,n(((z=t.special_request)==null?void 0:z.title)??""),1)])])):i("",!0)]),t.status_name=="Action Required"?(a(),o("button",{key:0,disabled:U.value,type:"button",class:"btn btn-big mt-4 bg-primary-600 text-white hover:bg-primary-700 disabled:bg-primary-400",onClick:l=>Y(t.id)}," Upload Invoice ",8,ss)):i("",!0)])])])])])])])):i("",!0)]}),_:2},1024)],64))),128))])])]),e("div",ts,[y(ie),y(de)])])]),_:1},8,["actionCount","inReviewCount","readyToSendCount","allPackagesCount"]),y(G,{show:T.value,onClose:b},{default:C(()=>[e("div",ls,[e("div",{class:"flex justify-between items-center"},[s[33]||(s[33]=e("h2",{class:"text-lg font-semibold text-gray-900"}," Upload Merchant Invoice ",-1)),e("button",{onClick:b,class:"text-gray-500 hover:text-gray-800"}," Close ")]),e("div",null,[e("input",{type:"file",multiple:"",onChange:s[4]||(s[4]=t=>H(t)),accept:".bmp, .jpg, .jpeg, .gif, .tif, .tiff, .pdf"},null,32),s[34]||(s[34]=e("p",{class:"text-sm text-gray-600 mt-1"}," Accepted File Types: BMP, JPG, JPEG, GIF, TIF, TIFF, PDF ",-1)),s[35]||(s[35]=e("p",{class:"text-sm text-gray-600"},"Max File Size: 2MB",-1))]),_.value.length?(a(),o("div",os,[s[36]||(s[36]=e("p",{class:"font-medium text-sm mb-1"},"Selected Files:",-1)),e("ul",as,[(a(!0),o(f,null,x(_.value,(t,p)=>(a(),o("li",{key:p},n(t.name),1))),128))])])):i("",!0),e("div",rs,[(a(!0),o(f,null,x(w.value,(t,p)=>(a(),o("div",{key:p,class:"relative group"},[t?(a(),o("img",{key:0,src:t,alt:"Preview",class:"w-full h-auto border rounded shadow"},null,8,ns)):i("",!0),e("button",{onClick:A=>V(p),class:"absolute top-1 right-1 bg-white text-red-500 border border-red-300 rounded-full p-1 text-xs opacity-80 group-hover:opacity-100 hover:bg-red-100",title:"Remove"}," ❌ ",8,us),t?i("",!0):(a(),o("div",ds,[h(n(_.value[p].type)+" preview not supported. ",1),e("button",{onClick:A=>V(p),class:"ml-2 text-red-500 underline text-xs"}," Remove ",8,is)]))]))),128))]),e("div",ps,[e("button",{onClick:s[5]||(s[5]=t=>b()),class:"px-4 py-2 text-sm text-gray-700 border"}," Cancel "),e("button",{onClick:K,class:"px-4 py-2 text-sm bg-primary-600 text-white"}," Upload Document ")])])]),_:1},8,["show"]),y(G,{show:q.value,onClose:b},{default:C(()=>[e("div",cs,[e("div",{class:"flex justify-between items-center"},[s[37]||(s[37]=e("h2",{class:"text-lg font-semibold text-gray-900"}," Package Photos ",-1)),e("button",{onClick:b,class:"text-gray-500 hover:text-gray-800"}," Close ")]),D.value.length>0?(a(),o("div",vs,[(a(!0),o(f,null,x(D.value,(t,p)=>(a(),o("img",{key:p,src:t.file_with_url,alt:"Package Photo",class:"rounded shadow border"},null,8,gs))),128))])):(a(),o("div",ys,s[38]||(s[38]=[e("h3",null,"No photos available",-1)])))])]),_:1},8,["show"])],64)}}},Rs=pe(fs,[["__scopeId","data-v-6959e0aa"]]);export{Rs as default};
